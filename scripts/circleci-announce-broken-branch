#! /usr/bin/env bash

#####
## Announce in Slack channel
#####
payload=$(
cat <<EOM
{
    "attachments": [
        {
            "fallback": "WARNING: $CIRCLE_PROJECT_REPONAME/$CIRCLE_BRANCH has failed to build!",
            "color": "danger",
            "title": "Build Failure:",
			"text": "*WARNING:* $CIRCLE_PROJECT_REPONAME/$CIRCLE_BRANCH has failed to build!",
			"ts": "$( date +%s )",
			"mrkdwn_in": ["text"]
        }
    ]
}
EOM
)

curl -X POST -H 'Content-type: application/json' --data "$payload" $SLACK_WEBHOOK_URL